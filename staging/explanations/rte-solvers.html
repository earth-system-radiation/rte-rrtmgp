<p>The <a href="../reference/rte-fortran-interface/proc/rte_lw.html">rte_lw()</a> and <a href="../reference/rte-fortran-interface/proc/rte_sw.html">rte_sw()</a> routines in the RTE library compute radiative transfer on a user-specified problem. Both routines allow for an upper boundary condition for spectrally-resolved diffuse radiation. <code class="language-plaintext highlighter-rouge">rte_sw()</code> is overloaded to allow users to specify either a single value of <code class="language-plaintext highlighter-rouge">mu0</code> per column or a value at each layer of each column.</p>

<p>If optical properties are specified as variables of type ty_optical_props_1scl (meaning extinction optical depth alone) in the longwave, radiative transfer is computed accounting for only emission and absorption. If optical properties are specified as variables of type <code class="language-plaintext highlighter-rouge">ty_optical_props_2str</code> (optical depth, single-scattering albedo, and asymmetry parameter) the rescaling and refinement method of <a href="https://doi.org/10.1175/JAS-D-18-0014.1">Tang et al. 2018</a> is used by default; two-stream and adding methods maybe be chosen by setting optional argument <code class="language-plaintext highlighter-rouge">use_2stream</code> to <code class="language-plaintext highlighter-rouge">.TRUE.</code></p>

<p>The sensitivity of broadband flux (W/m$^2$-K) to changes in surface temperature is available in optional output argument <code class="language-plaintext highlighter-rouge">flux_up_Jac</code> . Jacobians are not available if <code class="language-plaintext highlighter-rouge">use_2stream</code> is ``.TRUE.`</p>
